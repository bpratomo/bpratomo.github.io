<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OverReact Builder - MM</title>
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">


  <meta name="author" content="Budi Pratomo">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="MM">
<meta property="og:title" content="OverReact Builder">
<meta property="og:url" content="http://localhost:4000/dart_wordle/packages/over_react/src/builder/">


  <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">












<link rel="canonical" href="http://localhost:4000/dart_wordle/packages/over_react/src/builder/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="MM Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--default">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          MM
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      <h1 id="overreact-builder">OverReact Builder</h1>

<p><a href="#__START_EMBEDDED_README__"></a></p>

<p>OverReact components are declared using a set of “boilerplate” declarations which are 
picked up by the <code class="language-plaintext highlighter-rouge">over_react</code> builder.</p>

<p>This builder generates code, wiring up the different pieces of component 
declarations and creating typed getters/setters for props and state.</p>

<p>This allows boilerplate to be significantly reduced, making the code you write 
much cleaner and more <em>grokkable</em>.</p>

<blockquote>
  <p>Check out some <a href="https://workiva.github.io/over_react/demos/">component demos</a> to see the builder in action.</p>
</blockquote>

<p> 
 </p>

<h2 id="wiring-it-all-up">Wiring it all up</h2>

<p><strong>Be sure to familiarize yourself with the <a href="https://github.com/Workiva/over_react/blob/master/README.md">OverReact library</a> first.</strong></p>

<p>The builder wires up your factory, props class, and component class so that you don’t have to!</p>

<h3 id="the-generation-process">The generation process</h3>

<blockquote>
  <p>All of this generation happens “under the hood”, but you can see it in action for your 
own components by viewing the generated .over_react.g.dart file.</p>
</blockquote>

<ol>
  <li>
    <p>The builder parses files and looks for things to generate. Let’s start with this component:</p>

    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">UiFactory</span><span class="o">&lt;</span><span class="n">FooProps</span><span class="o">&gt;</span> <span class="n">Foo</span> <span class="o">=</span> <span class="n">castUiFactory</span><span class="o">(</span><span class="n">_$Foo</span><span class="o">);</span> <span class="c1">// undefined_identifier</span>
    
 <span class="n">mixin</span> <span class="n">FooProps</span> <span class="n">on</span> <span class="n">UiProps</span> <span class="o">{</span> 
   <span class="kt">int</span> <span class="n">foo</span><span class="o">;</span>
 <span class="o">}</span>
    
 <span class="kd">class</span> <span class="nc">FooComponent</span> <span class="kd">extends</span> <span class="n">UiComponent2</span><span class="o">&lt;</span><span class="n">FooProps</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nd">@override</span>
   <span class="n">render</span><span class="o">()</span> <span class="o">{</span> 
     <span class="c1">// ...</span>
   <span class="o">}</span>
 <span class="o">}</span>
</code></pre></div>    </div>

    <p>In <a href="parsing/members_from_ast.dart">parsing/members_from_ast.dart</a>, the builder identifies for top-level declarations that could be part of a component declaration:</p>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">UiFactory</code> variables</li>
      <li>Mixins that are <code class="language-plaintext highlighter-rouge">on UiProps</code> and whose names end with <code class="language-plaintext highlighter-rouge">Props</code> or <code class="language-plaintext highlighter-rouge">PropsMixin</code> (same thing for state)</li>
      <li>Classes that extend directly from <code class="language-plaintext highlighter-rouge">UiProps</code> and whose names end with <code class="language-plaintext highlighter-rouge">Props</code></li>
      <li>Classes whose names end with <code class="language-plaintext highlighter-rouge">Component</code></li>
    </ul>

    <p>Then, in, <a href="parsing/declarations_from_members.dart">parsing/declarations_from_members.dart</a>, it uses the names of these declarations to group them together, and determines whether those groups are actually an over_react declaration that needs code generation (vs unrelated code that happens to look similar).</p>

    <p>In this case:</p>
    <ol>
      <li>The builder identifies the compilation unit members <code class="language-plaintext highlighter-rouge">Foo</code>, <code class="language-plaintext highlighter-rouge">FooProps</code>, <code class="language-plaintext highlighter-rouge">FooComponent</code>, which all look like pieces of over_react boilerplate.</li>
      <li>The builder sees that <code class="language-plaintext highlighter-rouge">FooProps</code> meets the requirements for declaring a props mixin, and thus  can confidently proceed with code generation for it.
        <ul>
          <li>Props mixins need code generation regardless of whether they’re associated with a component, since they can be declared on their own.</li>
        </ul>
      </li>
      <li>The builder starts with the factory, and looks for other members with matching names that it could use to create a complete group that forms a class component. It finds all the pieces it needs:
        <ul class="task-list">
          <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />a factory: <strong><em>Foo</em></strong></li>
          <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />either a props mixin or a concrete props class:  <strong><em>Foo</em></strong>Props</li>
          <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />either a state mixin or a concrete state class (optional)</li>
          <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />a component class: <strong><em>Foo</em></strong>Component</li>
        </ul>
      </li>
      <li>The builder checks to see if the group is really an over_react declaration that needs code generation. It sees that the factory is referencing a generated variable (<code class="language-plaintext highlighter-rouge">Foo = _$Foo</code>) and thus can confidently say that the factory needs code generation. Because of that, it proceeds with code generation for all the members in this group.</li>
    </ol>

    <p>The builder has recognized our code as a class component that requires code generation! If it hadn’t, the builder would have gone through similar logic to identify other types of declarations like function components and props map views, and perform similar code generation to wire them up.</p>

    <p>Next up, let’s see what code generation looks like for our class component.</p>
  </li>
  <li>The builder generates a version of the props mixin which contains concrete 
getters/setters.
    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mixin</span> <span class="n">$FooProps</span> <span class="n">on</span> <span class="n">FooProps</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="kd">get</span> <span class="n">foo</span> <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.foo'</span><span class="o">];</span>
  <span class="kd">set</span> <span class="n">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.foo'</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span> 
</code></pre></div>    </div>
  </li>
  <li>The builder creates a concrete props implementation class, which mixes in the generated props mixin:
    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">class</span> <span class="nc">_</span><span class="err">$</span><span class="n">$FooProps</span> <span class="kd">extends</span> <span class="n">UiProps</span> <span class="k">with</span> <span class="n">FooProps</span><span class="o">,</span> <span class="n">$FooProps</span> <span class="o">{</span>
   <span class="o">...</span>   
 <span class="o">}</span>
</code></pre></div>    </div>
    <p>This concrete class is what will be used everywhere for this component’s typed props (returned from the <code class="language-plaintext highlighter-rouge">UiFactory</code>, available via <code class="language-plaintext highlighter-rouge">props</code> inside <code class="language-plaintext highlighter-rouge">render</code>).</p>

    <p>Note that in the above example, our component has props declared via just a props mixin, which is a shorthand syntax for when no additional props are needed from other mixins. For components with concrete props classes which mix in other props, the implementation is similar. The generated concrete props class mixes in all generated mixins corresponding to the props mixins used:</p>

    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// Authored code:</span>
 <span class="n">UiFactory</span><span class="o">&lt;</span><span class="n">BarProps</span><span class="o">&gt;</span> <span class="n">Bar</span> <span class="o">=</span> <span class="n">castUiFactory</span><span class="o">(</span><span class="n">_$Bar</span><span class="o">);</span>
 <span class="kd">class</span> <span class="nc">BarProps</span> <span class="o">=</span> <span class="n">UiProps</span> <span class="k">with</span> <span class="n">BarPropsMixin</span><span class="o">,</span> <span class="n">FooProps</span><span class="o">;</span>
 <span class="kd">class</span> <span class="nc">BarComponent</span> <span class="kd">extends</span> <span class="n">UiComponent2</span><span class="o">&lt;</span><span class="n">BarProps</span><span class="o">&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
    
 <span class="c1">// Generated code:</span>
 <span class="kd">class</span> <span class="nc">_</span><span class="err">$</span><span class="n">$BarProps</span> <span class="kd">extends</span> <span class="n">UiProps</span> 
     <span class="k">with</span> 
         <span class="n">BarPropsMixin</span><span class="o">,</span> <span class="n">$BarPropsMixin</span><span class="o">,</span> 
         <span class="n">FooProps</span><span class="o">,</span> <span class="n">$FooProps</span>
     <span class="kd">implements</span> <span class="n">BarProps</span> <span class="o">{</span>
   <span class="o">...</span>   
 <span class="o">}</span>
</code></pre></div>    </div>

    <p>It also overrides stubbed out <code class="language-plaintext highlighter-rouge">UiProps</code> members, and implements a constructor that delegates to other generated subclasses: one optimized for <code class="language-plaintext highlighter-rouge">JsBackedMap</code>, and one used for all other <code class="language-plaintext highlighter-rouge">Map</code>s.</p>
    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">class</span> <span class="nc">_</span><span class="err">$</span><span class="n">$FooProps</span> <span class="kd">extends</span> <span class="n">UiProps</span> <span class="k">with</span> <span class="n">FooProps</span><span class="o">,</span> <span class="n">$FooProps</span> <span class="o">{</span>
   <span class="kd">factory</span> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps</span><span class="o">(</span><span class="n">Map</span> <span class="n">backingMap</span><span class="o">)</span> <span class="o">{</span>
     <span class="k">if</span> <span class="o">(</span><span class="n">backingMap</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">backingMap</span> <span class="k">is</span> <span class="n">JsBackedMap</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps$JsMap</span><span class="o">(</span><span class="n">backingMap</span><span class="o">);</span>
     <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps$PlainMap</span><span class="o">(</span><span class="n">backingMap</span><span class="o">);</span>
     <span class="o">}</span>
   <span class="o">}</span>
    
   <span class="c1">/// The backing props map proxied by this class.</span>
   <span class="nd">@override</span>
   <span class="n">Map</span> <span class="kd">get</span> <span class="n">props</span> <span class="o">=&gt;</span> <span class="n">_props</span><span class="o">;</span>
   <span class="kd">final</span> <span class="n">Map</span> <span class="n">_props</span><span class="o">;</span>
    
   <span class="c1">/// Let [UiProps] internals know that this class has been generated.</span>
   <span class="nd">@override</span>
   <span class="kt">bool</span> <span class="kd">get</span> <span class="n">$isClassGenerated</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="o">;</span>
    
   <span class="c1">/// The `ReactComponentFactory` associated with the component built by this class.</span>
   <span class="nd">@override</span>
   <span class="n">ReactComponentFactoryProxy</span> <span class="kd">get</span> <span class="n">componentFactory</span> <span class="o">=&gt;</span> <span class="n">$FooComponentFactory</span><span class="o">;</span>   
 <span class="o">}</span>
</code></pre></div>    </div>

    <p>Note that the <code class="language-plaintext highlighter-rouge">typedPropsFactory</code> variable is wired up to use the props implementation 
 class’s constructor. This lets us get an instance of that class when we use the <code class="language-plaintext highlighter-rouge">props</code> 
 getter and the <code class="language-plaintext highlighter-rouge">newProps()</code> method, and is necessary since the code we wrote 
 doesn’t have a proper constructor.</p>
  </li>
  <li>
    <p>Our fully implemented component class is registered with the <a href="https://github.com/cleandart/react-dart">react-dart</a> wrapper.</p>

    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// React component factory implementation.</span>
 <span class="c1">//</span>
 <span class="c1">// Registers component implementation and links type meta to builder factory.</span>
 <span class="kd">final</span> <span class="n">$FooComponentFactory</span> <span class="o">=</span> <span class="n">registerComponent2</span><span class="o">(</span>
   <span class="o">()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="n">_$FooComponent</span><span class="o">(),</span>
   <span class="nl">builderFactory:</span> <span class="n">Foo</span><span class="o">,</span>
   <span class="nl">componentClass:</span> <span class="n">FooComponent</span><span class="o">,</span>
   <span class="nl">isWrapper:</span> <span class="kc">false</span><span class="o">,</span>
   <span class="nl">parentType:</span> <span class="kc">null</span><span class="o">,</span>
   <span class="nl">displayName:</span> <span class="s">'Foo'</span><span class="o">,</span>
 <span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Finally, the initializer for our factory (<code class="language-plaintext highlighter-rouge">_$Foo</code>) is generated with a function that returns a new instance of our 
private props implementation. This factory is <strong>the entry-point</strong> to externally consuming our 
component and props class.</p>

    <div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps</span> <span class="n">_$Foo</span><span class="o">([</span><span class="n">Map</span> <span class="n">backingProps</span><span class="o">])</span> <span class="o">=&gt;</span> <span class="n">backingProps</span> <span class="o">==</span> <span class="kc">null</span>
     <span class="o">?</span> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps$JsMap</span><span class="o">(</span><span class="n">JsBackedMap</span><span class="o">())</span>
     <span class="o">:</span> <span class="n">_</span><span class="err">$</span><span class="n">$FooProps</span><span class="o">(</span><span class="n">backingProps</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<p> 
 </p>

<h2 id="props--state-getters-and-setters">Props / State Getters and Setters</h2>

<p>Writing a statically-typed prop / state API for React components in Dart proved to be a huge pain when we 
attempted to do it from scratch.</p>

<p>We found that the most straightforward way to adhere to React patterns was to use <code class="language-plaintext highlighter-rouge">Map</code>s for <code class="language-plaintext highlighter-rouge">props</code> and <code class="language-plaintext highlighter-rouge">state</code>.</p>

<p>So we went about defining typed getters and setters on <code class="language-plaintext highlighter-rouge">MapView</code>-like classes which proxy Map key-value pairs. 
However, typing these getters and setters quickly became tedious 
<em>(especially if you need namespaced keys for platform scalability)</em>:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">FooProps</span> <span class="kd">extends</span> <span class="n">UiProps</span> <span class="o">{</span>
  <span class="kt">String</span> <span class="kd">get</span> <span class="n">title</span>               <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.title'</span><span class="o">];</span>
  <span class="kd">set</span> <span class="n">title</span><span class="o">(</span><span class="kt">String</span> <span class="n">value</span><span class="o">)</span>        <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.title'</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>

  <span class="kt">bool</span> <span class="kd">get</span> <span class="n">isEnabled</span>             <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.isEnabled'</span><span class="o">];</span>
  <span class="kd">set</span> <span class="n">isEnabled</span><span class="o">(</span><span class="kt">bool</span> <span class="n">value</span><span class="o">)</span>      <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.isEnabled'</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>

  <span class="n">MouseEventCallback</span> <span class="kd">get</span> <span class="n">onClick</span> <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.onClick'</span><span class="o">];</span>
  <span class="kd">set</span> <span class="n">onClick</span><span class="o">(</span><span class="n">Callback</span> <span class="n">value</span><span class="o">)</span>    <span class="o">=&gt;</span> <span class="n">props</span><span class="o">[</span><span class="s">'FooProps.onClick'</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>

  <span class="c1">// Imagine a component with 20 of these... yuck.</span>
<span class="o">}</span>
</code></pre></div></div>

<p>With the builder, we cut down on repetition while preserving statically-typed getter and setters.</p>

<p>Props and state are declared using <em>fields</em>, making the actual code you write much simpler - 
and much more like the React JS library intended:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mixin</span> <span class="n">FooProps</span> <span class="n">on</span> <span class="n">UiProps</span> <span class="o">{</span>
  <span class="kt">String</span> <span class="n">title</span><span class="o">;</span>

  <span class="kt">bool</span> <span class="n">isEnabled</span><span class="o">;</span>

  <span class="n">MouseEventCallback</span> <span class="n">onClick</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>

<span class="n">mixin</span> <span class="n">FooState</span> <span class="n">on</span> <span class="n">UiState</span> <span class="o">{</span>
  <span class="kt">bool</span> <span class="n">isShown</span><span class="o">;</span>

  <span class="kt">String</span> <span class="n">currentText</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>Check out some <a href="https://workiva.github.io/over_react/demos/">component demos</a> for more info about using fields to define props and state values in the real world.</p>
</blockquote>

<p> 
 </p>


    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 MM. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
